let dot(x: vector*3, y: vector*3): real =
	(x*y).sum in

let magnitude(x: vector*3): real =
	sqrt(dot(x, x)) in

// xyz normalised to the lunar surface (i.e. at altitude 0).
let xyzn = (xyz / magnitude(xyz)) * nominal_radius in

let scale = 3e3 in

let c = (sin(xyzn/scale)/2) + 0.5 in
let emission = sun_colour*c in
return
